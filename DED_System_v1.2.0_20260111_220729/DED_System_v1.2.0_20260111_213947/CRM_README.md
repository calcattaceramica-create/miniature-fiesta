# نظام إدارة علاقات العملاء (CRM)

## نظرة عامة
نظام CRM متكامل لإدارة العلاقات مع العملاء، يشمل إدارة العملاء المحتملين، الفرص التجارية، التفاعلات، المهام، والحملات التسويقية.

## المكونات الرئيسية

### 1. العملاء المحتملون (Leads)
- إدارة قاعدة بيانات العملاء المحتملين
- تتبع حالة كل عميل محتمل (جديد، تم الاتصال، مؤهل، مفقود)
- تقييم العملاء المحتملين (1-5 نجوم)
- تحويل العملاء المحتملين إلى عملاء فعليين
- تتبع المصدر والإيراد المتوقع

### 2. الفرص التجارية (Opportunities)
- إدارة الفرص التجارية
- تتبع مراحل البيع (استكشاف، تأهيل، عرض، تفاوض، إغلاق)
- حساب القيمة المتوقعة بناءً على المبلغ والاحتمالية
- ربط الفرص بالعملاء والعملاء المحتملين

### 3. التفاعلات (Interactions)
- تسجيل جميع التفاعلات مع العملاء
- أنواع التفاعلات: مكالمات، بريد إلكتروني، اجتماعات، ملاحظات
- تتبع النتائج والمدة
- ربط التفاعلات بالعملاء المحتملين، العملاء، والفرص

### 4. المهام (Tasks)
- إدارة المهام المتعلقة بالعملاء
- تحديد الأولويات (منخفضة، عادية، عالية، عاجلة)
- تتبع الحالة (معلقة، قيد التنفيذ، مكتملة، ملغاة)
- تعيين المهام للمستخدمين
- تحديد تواريخ الاستحقاق

### 5. الحملات التسويقية (Campaigns)
- إدارة الحملات التسويقية
- تتبع الميزانية والتكلفة الفعلية
- قياس الأداء (ROI، معدل التحويل، تكلفة العميل المحتمل)
- أنواع الحملات: بريد إلكتروني، وسائل التواصل، إعلانات مدفوعة، أحداث، ندوات

## الصفحات المتاحة

### لوحة التحكم
- `/crm/` أو `/crm/dashboard`
- عرض إحصائيات شاملة عن النظام
- رسوم بيانية للأداء
- قائمة بالمهام المعلقة والفرص النشطة

### العملاء المحتملون
- `/crm/leads` - قائمة العملاء المحتملين
- `/crm/leads/add` - إضافة عميل محتمل جديد
- `/crm/leads/<id>` - تفاصيل العميل المحتمل
- `/crm/leads/<id>/edit` - تعديل العميل المحتمل
- `/crm/leads/<id>/convert` - تحويل إلى عميل فعلي

### الفرص التجارية
- `/crm/opportunities` - قائمة الفرص
- `/crm/opportunities/add` - إضافة فرصة جديدة
- `/crm/opportunities/<id>` - تفاصيل الفرصة

### التفاعلات
- `/crm/interactions` - قائمة التفاعلات
- `/crm/interactions/add` - إضافة تفاعل جديد

### المهام
- `/crm/tasks` - قائمة المهام
- `/crm/tasks/add` - إضافة مهمة جديدة

### الحملات التسويقية
- `/crm/campaigns` - قائمة الحملات
- `/crm/campaigns/add` - إضافة حملة جديدة
- `/crm/campaigns/<id>` - تفاصيل الحملة

## التثبيت والإعداد

### 1. تحديث قاعدة البيانات
```bash
python update_crm_database.py
```

### 2. إضافة بيانات تجريبية (اختياري)
```bash
python seed_crm_data.py
```

## الميزات الرئيسية

### البحث والتصفية
- بحث متقدم في جميع الوحدات
- تصفية حسب الحالة، المرحلة، النوع، إلخ
- ترتيب النتائج

### التقارير والإحصائيات
- إحصائيات شاملة في لوحة التحكم
- تقارير الأداء للحملات
- تتبع معدلات التحويل

### الربط بين الوحدات
- ربط التفاعلات والمهام بالعملاء المحتملين والفرص
- تحويل العملاء المحتملين إلى عملاء فعليين
- ربط الفرص بالعملاء والعملاء المحتملين

### إدارة المستخدمين
- تعيين المسؤولين للعملاء المحتملين والفرص والمهام
- تتبع من قام بإنشاء السجلات

## قاعدة البيانات

### الجداول الرئيسية
1. **leads** - العملاء المحتملون
2. **opportunities** - الفرص التجارية
3. **interactions** - التفاعلات
4. **tasks** - المهام
5. **campaigns** - الحملات التسويقية
6. **contacts** - جهات الاتصال

### العلاقات
- Lead → Customer (تحويل)
- Lead → Interactions (تفاعلات)
- Lead → Tasks (مهام)
- Opportunity → Customer (عميل)
- Opportunity → Lead (عميل محتمل)
- Opportunity → Interactions (تفاعلات)
- Opportunity → Tasks (مهام)

## الملفات الرئيسية

### Backend
- `app/models_crm.py` - نماذج قاعدة البيانات
- `app/crm/routes.py` - المسارات والمنطق
- `app/crm/__init__.py` - تهيئة الوحدة

### Frontend
- `app/templates/crm/` - جميع صفحات HTML
- `app/templates/crm/dashboard.html` - لوحة التحكم
- `app/templates/crm/leads.html` - قائمة العملاء المحتملين
- `app/templates/crm/opportunities.html` - قائمة الفرص
- وغيرها...

### Scripts
- `update_crm_database.py` - تحديث قاعدة البيانات
- `seed_crm_data.py` - إضافة بيانات تجريبية

## ملاحظات مهمة

1. تأكد من تشغيل `update_crm_database.py` قبل استخدام النظام
2. يمكن استخدام `seed_crm_data.py` لإضافة بيانات تجريبية للاختبار
3. جميع الصفحات محمية بنظام تسجيل الدخول
4. يتم تتبع جميع العمليات بتواريخ الإنشاء والتحديث

## التطوير المستقبلي

- [ ] إضافة تقارير متقدمة
- [ ] إضافة رسوم بيانية تفاعلية
- [ ] إضافة نظام الإشعارات
- [ ] إضافة تكامل مع البريد الإلكتروني
- [ ] إضافة نظام الأتمتة للمهام
- [ ] إضافة تصدير البيانات (Excel, PDF)

